<!-- header with a dropdown menu and login -->
<header class="siteheader">
  <div class="site-logo">
    <a href="./index.html" class="site-logo">LEARN LOCAL</a>
    <div class="dropdown">
      <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown"
        aria-haspopup="true" aria-expanded="false">
        Browse
      </a>

      <div class="dropdown-content">
        <a class="dropdown-item" href="#">Creative</a>
        <a class="dropdown-item" href="#">Business</a>
        <a class="dropdown-item" href="#">Lifestyle</a>
        <a class="dropdown-item" href="#">Other</a>
      </div>
    </div>

    <!-- Login  -->
    <button class="sign" onclick="document.getElementById('id01').style.display='block'"
      style="width:auto;">Login</button>

    <div id="id01" class="modal">

      <form class="modal-content animate" action="/action_page.php">
        <div class="imgcontainer">
          <span onclick="document.getElementById('id01').style.display='none'" class="close"
            title="Close Modal">&times;</span>
          <img src="../images/login.png" alt="Avatar" class="avatar">
        </div>

        <div class="login-container">
          <label for="uname"><b>Username</b></label>
          <input type="text" placeholder="Enter Username" name="uname" required>

          <label for="psw"><b>Password</b></label>
          <input type="password" placeholder="Enter Password" name="psw" required>

          <button class="login-button" type="submit">Login</button>
          <label>
            <input type="checkbox" checked="checked" name="remember"> Remember me
          </label>
        </div>

        <div class="login-container" style="background-color:#f1f1f1">
          <button type="button" onclick="document.getElementById('id01').style.display='none'"
            class="cancelbtn">Cancel</button>
          <span class="psw">Forgot <a href="#">password?</a></span>
        </div>
      </form>
    </div>
  </div>
</header>
<div class="container">

  <h1>Learn!</h1>

  <hr>

  <h2>Sign up for a <span class="selectedCategory">[category selected]</span> class happening in your neighborhood.
  </h2>

  <div class="AppDescriptionContainer">
    <p>Insert instructions for how to sign up for a class.
    </p>
  </div>

  <hr>

  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-body">
          <ul id="selectedCategoryResults" class="list-group">
            <!-- !!!!!!!!!! delete this mock result -->
            <li class='ClassInSelectedCategory'>
              <h1>Class: Spoon carving</h1>
              <p><strong>Taught by:</strong> Luke Garrison</p>
              <p><strong>Location:</strong> 124 Bolinas Road, Fairfax, CA 94930</p>
              <p><strong>Date:</strong> Wednesday, June 12th, 2019</p>
              <p><strong>Time:</strong> 2:30PM - 5:30PM</p>
              <p><strong>Description:</strong> Wooden blanks and carving tools provided. Beginners welcome. Come learn
                how to carve a wooden spoon, how to oil and finish the spoon, and how to take care of your new spoon.
              </p>
              <div class="text-center"><button type="button" class="btn btn-lg btn-success signUpButton">
                  <h4>Sign up now!</h4>
                </button></div>
            </li>
            <li class='ClassInSelectedCategory'>
              <h1>Class: Wooden heart pendants</h1>
              <p><strong>Taught by:</strong> Hetty Chin</p>
              <p><strong>Location:</strong> 124 Bolinas Road, Fairfax, CA 94930</p>
              <p><strong>Date:</strong> Wednesday, June 12th, 2019</p>
              <p><strong>Time:</strong> 2:30PM - 5:30PM</p>
              <p><strong>Description:</strong> Wooden blanks and carving tools provided. Beginners welcome. Come learn
                how to carve a wooden heart pendant, add an eyelet, and braid a new cord for your new necklace. </p>
              <div class="text-center"><button type="button" class="btn btn-lg btn-success signUpButton">
                  <h4>Sign up now!</h4>
                </button></div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>

  <hr>

  <div class="AppDescriptionContainer">
    <p>Search for different type of class.
    </p>
  </div>

  <div class="classCategoriesContainer">
    <button type="button" class="btn btn-lg btn-success categoryButton">
      <h4>Soap making</h4>
    </button>
    <button type="button" class="btn btn-lg btn-success categoryButton">
      <h4>Spoon carving</h4>
    </button>
    <button type="button" class="btn btn-lg btn-success categoryButton">
      <h4>Knitting</h4>
    </button>
    <button type="button" class="btn btn-lg btn-success categoryButton">
      <h4>Yoga</h4>
    </button>
    <button type="button" class="btn btn-lg btn-success categoryButton">
      <h4>Painting</h4>
    </button>
  </div>

  <hr>

  <div class="AppDescriptionContainer">
    <p>Host a class of your own!</p>
  </div>

  <div class="teachButtonContainer">
    <a href="/teach"><button type="button" class="btn btn-lg btn-success teachButton">
        <h4>Teach</h4>
      </button></a>
  </div>

  <!-- Modal -->
  <div id="signUpModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h2 class="modal-title"><strong>Class name</strong></h2>
        </div>
        <div class="modal-body">
          <h2 id="match-name"></h2>
          <img id="match-img" style="max-width: 500px">
          <div class="signUpForm">
            <form>
              <div class="form-group">
                <label for="studentsName">Your name:</label>
                <textarea class="form-control" id="studentsName" rows="1"></textarea>
              </div>

              <div class="form-group">
                <label for="exampleFormControlInput1">Your email address:</label>
                <input type="email" class="form-control" id="exampleFormControlInput1" placeholder="name@example.com">
              </div>

              <div class="form-group">
                <label for="numberInParty">How many people are in your party?</label>
                <select multiple class="form-control" id="numberInParty">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                </select>
              </div>

            </form>
          </div>
        </div>
        <div class="modal-footer text-center">
          <button type="button" class="btn btn-lg btn-success signUpButton" data-dismiss="modal">
            <h4>Sign up!</h4>
          </button>
        </div>
      </div>

    </div>
  </div>
</div>
<!-- Custom Script -->
{{!-- I tried to connect to the js but it doesn't read it so I had to add it in here directly --}}
<script src="/public/js/index.js" type="text/javascript"></script>
<script>
  // run everything when the window loads
  window.onload = function () {
    console.log('index page has loaded')
    // Get references to page elements
    var $classCategoriesContainer = document.querySelector('.classCategoriesContainer')
    // our initial categories array
    var categories = []
    // our initial uniqueCategoriesButtonsToAdd
    var uniqueCategoriesButtonsToAdd = []
    // getting categories when the page loads
    getCategories()
    // this function clears existing dummy buttons
    function clearDummyButtons() {
      $classCategoriesContainer.innerHTML = ''
      console.log('all existing categories buttons have been erased')
    }
    // this function removes duplicate categoryButtons
    function getUnique(array) {
      var uniqueArray = []
      for (i = 0; i < array.length; i++) {
        if (uniqueArray.indexOf(array[i]) === -1) {
          uniqueArray.push(array[i])
        }
      }
      return uniqueArray
    }
    // this function displays the category buttons
    function displayButtons() {
      console.log('displayButtons function was called')
      clearDummyButtons()
      var categoryButtonsToAdd = []
      for (var i = 0; i < categories.length; i++) {
        categoryButtonsToAdd.push(createNewCategoryButton(categories[i]))
      }
      console.log('these are the categoryButtonsToAdd: ' + categoryButtonsToAdd)
      // capture only unique buttons
      uniqueCategoryButtonsToAdd = getUnique(categoryButtonsToAdd)
      console.log('the new unique buttons are: ' + uniqueCategoryButtonsToAdd)
      $classCategoriesContainer.insertAdjacentHTML('afterbegin', uniqueCategoryButtonsToAdd)
    }
    // this function grabs the categories from the database and updates the view
    function getCategories() {
      fetch('/allData')
        .then(results => results.json())
        .then(function (data) {
          categories = data
          console.log('got all data', categories)
          displayButtons(categories)
        })
    }

    // this function constructs a new category button
    function createNewCategoryButton(category) {
      console.log('createNewCategoryButton function was called')
      let newCategoryButton = `<a href="/learn/${category.category}"><button type="button" class="btn btn-lg btn-success categoryButton" data-id='${category.category}'><h4>${category.category}</h4></button></a>`
      return newCategoryButton
    }
    // !!!!!this function removes the comma from the buttons array
  }
</script>